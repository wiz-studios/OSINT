<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WireTapper • Wireless OSINT Dashboard</title>

    <link rel="preconnect" href="https://unpkg.com" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />

    <link rel="stylesheet" href="{{ url_for('static', filename='app.css') }}" />
  </head>

  <body>
    <div class="app" id="app" data-theme="dark">
      <header>
        <div class="bar">
          <div class="brand">
            <div class="logo" aria-hidden="true"></div>
            <div>
              <h1>WireTapper</h1>
              <p>Passive wireless OSINT & signal intelligence (local)</p>
            </div>
          </div>
          <div class="actions">
            <button id="btn-locate" class="primary" type="button">Locate</button>
            <button id="btn-clear" type="button">Clear</button>
            <button id="btn-export" type="button">Export JSON</button>
            <button id="btn-theme" type="button">Theme</button>
          </div>
        </div>
      </header>

      <main>
        <section class="panel" aria-label="Controls and results">
          <div class="p grid">
            <div>
              <h2>Query</h2>
              <p class="sub">Click the map to set coordinates. Your API keys stay server-side.</p>
            </div>

            <div class="row2">
              <div>
                <label for="lat">Latitude</label>
                <input id="lat" inputmode="decimal" placeholder="51.505" />
              </div>
              <div>
                <label for="lon">Longitude</label>
                <input id="lon" inputmode="decimal" placeholder="-0.09" />
              </div>
            </div>

            <div class="row2">
              <div>
                <label for="mode">Nearby mode</label>
                <select id="mode">
                  <option value="wifi">Wi-Fi</option>
                  <option value="bluetooth">Bluetooth</option>
                </select>
              </div>
              <div>
                <label for="searchType">Search type</label>
                <select id="searchType">
                  <option value="location">Location</option>
                  <option value="ssid">SSID</option>
                  <option value="bssid">BSSID</option>
                  <option value="network">Network (Shodan)</option>
                </select>
              </div>
            </div>

            <div>
              <label for="searchQuery">Search query</label>
              <input id="searchQuery" placeholder="For location: lat,lon • For ssid/bssid: value" />
              <div class="hint" style="margin-top: 6px">Location search expects <code>lat,lon</code>.</div>
            </div>

            <div class="seg">
              <button id="btn-nearby" class="primary" type="button">Nearby</button>
              <button id="btn-search" type="button">Search</button>
              <button id="btn-towers" type="button">Towers</button>
              <button id="btn-celltower" type="button">Celltower (GeoJSON)</button>
            </div>

            <div class="row2">
              <div>
                <label for="filterText">Filter results</label>
                <input id="filterText" placeholder="Type to filter (vendor, ssid, ip, etc.)" />
              </div>
              <div>
                <label>Type chips</label>
                <div class="chip-row">
                  <div class="chip" role="button" tabindex="0" aria-pressed="false" data-chip="router">
                    <span class="dot2 router"></span>Wi-Fi
                  </div>
                  <div class="chip" role="button" tabindex="0" aria-pressed="false" data-chip="bluetooth">
                    <span class="dot2 bluetooth"></span>BT
                  </div>
                  <div class="chip" role="button" tabindex="0" aria-pressed="false" data-chip="cell">
                    <span class="dot2 cell"></span>Cell
                  </div>
                  <div class="chip" role="button" tabindex="0" aria-pressed="false" data-chip="iot">
                    <span class="dot2 iot"></span>IoT
                  </div>
                  <div class="chip" role="button" tabindex="0" aria-pressed="false" data-chip="camera">
                    <span class="dot2 camera"></span>Cam
                  </div>
                </div>
              </div>
            </div>

            <div class="row2">
              <div class="pill" id="status"><b>Status</b> <span id="statusText">Ready</span></div>
              <div class="pill" id="providers"><b>Providers</b> <span id="providersText">Checking…</span></div>
            </div>

            <div>
              <h2>Saved locations</h2>
              <p class="sub">Store locations in your browser (localStorage) for quick re-runs.</p>
              <div class="row2" style="margin-top: 10px">
                <div>
                  <label for="savedName">Name</label>
                  <input id="savedName" placeholder="Home / Office / Site" />
                </div>
                <div style="display: grid; align-items: end">
                  <button id="btn-save-location" type="button">Save current</button>
                </div>
              </div>
              <div id="savedList" style="margin-top: 10px"></div>
            </div>
          </div>

          <div class="results" id="results" aria-label="Results list"></div>
        </section>

        <section aria-label="Map">
          <div id="map"></div>
        </section>
      </main>
    </div>

    <div class="drawer" id="drawer" aria-label="Details drawer" aria-hidden="true">
      <div class="backdrop" id="drawerBackdrop"></div>
      <div class="sheet" role="dialog" aria-modal="true" aria-label="Details">
        <header>
          <h3 id="drawerTitle">Details</h3>
          <div class="spacer"></div>
          <button id="drawerClose" type="button">Close</button>
        </header>
        <div class="content">
          <pre id="drawerJson"></pre>
        </div>
        <footer>
          <button id="drawerCopy" class="primary" type="button">Copy JSON</button>
        </footer>
      </div>
    </div>

    <div class="toast" id="toast" role="status" aria-live="polite" data-kind="ok">
      <div class="dot"></div>
      <div>
        <h3 id="toastTitle">Notice</h3>
        <p id="toastBody"></p>
      </div>
      <button id="toastClose" type="button">Close</button>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
    <script src="{{ url_for('static', filename='app.js') }}"></script>
  </body>
</html>
